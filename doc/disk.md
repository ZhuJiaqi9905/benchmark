# 文件IO的benchmark

## read file

顺序读取一个约1G到文件。每次读buf_len长度的内容到缓冲区中。

做round轮读取，得到读取的总文件大小和总时间，计算吞吐量MB/s。
* File:: Read

buf_len(B) | throughput(MB/s)
--------|-----------
1024 | 1233.026
2048 | 2150.412
3072 | 2770.663
4096 | 3395.353
5120 | 3672.376
102400 | 6368.669
409600 | 6361.419
1024000 | 6119.038
4096000 | 6109.476

* BufReader

buf_len(B) | throughput(MB/s)
--------|-----------
1024 | 3387.283
2048 | 4313.264
3072 | 4317.124
4096 | 4293.708
5120 | 4057.761
102400 | 6558.638
409600 | 6407.491
1024000 | 6119.038
4096000 | 6109.476
结论：

* 读文件到带宽在6GB/s左右
* BufReader的性能要优于直接调用File的read。优先使用BufReader读取文件

## write file

把1G的数据顺序写到文件中，每次写buf_len长度的内容

* BufWriter

buf_len(B) | throughput(MB/s)
------- | ----------
102400 | 1658.707
409600 | 1722.568
1024000 | 1726.061
4096000 | 1729.674

结论：

* 顺序写的带宽大概在1.5GB/s左右
- 和读文件，rdma read相比，写文件的确是性能瓶颈
